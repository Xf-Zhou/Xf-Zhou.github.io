<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#6200ee"><meta name="author" content="xfzhou"><meta name="copyright" content="xfzhou"><meta name="generator" content="Hexo 4.2.1"><meta name="theme" content="hexo-theme-yun"><title>JVM | 恍惚斋</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;family=Source+Code+Pro&amp;display=swap" media="none" onload="this.media='all'"><script src="//at.alicdn.com/t/font_1140697_pem9yni52s.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link rel="shortcut icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#6200ee"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"root":"/","title":"恍惚斋","version":"0.9.0","anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"fireworks":{"colors":["104, 100, 189","93, 175, 189","11, 163, 42"]}};
  </script><meta name="description" content="JVM初探参考：https:&#x2F;&#x2F;www.kuangstudy.com&#x2F;bbs&#x2F;1366583294535151617 https:&#x2F;&#x2F;www.kuangstudy.com&#x2F;bbs?searchKey&#x3D;JVM&amp;cid&#x3D;&amp;pageNo&#x3D;1&amp;pageSize&#x3D;15 一些常见面试题：  请你谈谈你对JVM的理解？java8虚拟机和之前的变化更新？ 什么是OOM，什么是栈溢出Stac">
<meta property="og:type" content="article">
<meta property="og:title" content="JVM">
<meta property="og:url" content="https://xfzhou95.com/2021/03/02/JVM/index.html">
<meta property="og:site_name" content="恍惚斋">
<meta property="og:description" content="JVM初探参考：https:&#x2F;&#x2F;www.kuangstudy.com&#x2F;bbs&#x2F;1366583294535151617 https:&#x2F;&#x2F;www.kuangstudy.com&#x2F;bbs?searchKey&#x3D;JVM&amp;cid&#x3D;&amp;pageNo&#x3D;1&amp;pageSize&#x3D;15 一些常见面试题：  请你谈谈你对JVM的理解？java8虚拟机和之前的变化更新？ 什么是OOM，什么是栈溢出Stac">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210129163223110.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210302225944378.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210131113845513.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210302231842145.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210129173753042.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210302231526982.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210302232506504.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210129185753713.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210302235015964.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210131125351239.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303001750615.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303003544368.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210201182918164.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303005244314.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210201185248813.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303005702448.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303005732094.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303005754086.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303005808844.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303005836279.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303005852873.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303005911807.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210201210010927.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210201212708979.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210201215342076.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303134431520.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210201222307209.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210201230739376.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210201230953431.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210202134131995.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210202140158342.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303142057401.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303142134391.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210202140606282.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210202172145431.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210202173224815.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210202191444745.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303144317200.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210202200613995.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303144607610.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303145636120.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210202203154896.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210303145906612.png">
<meta property="og:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210202211809212.png">
<meta property="article:published_time" content="2021-03-02T14:52:01.962Z">
<meta property="article:modified_time" content="2021-03-03T07:23:12.007Z">
<meta property="article:author" content="xfzhou">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xfzhou95.com/2021/03/02/JVM/JVM.assets/image-20210129163223110.png"><script src="/js/ui/mode.js"></script><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle sidebar-toggle-fixed hty-icon-button"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><aside class="sidebar"><script defer src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="xfzhou"><img width="96" loading="lazy" src="/images/avatar.jpg" alt="xfzhou"></a><div class="site-author-name"><a href="/about/">xfzhou</a></div><a class="site-name" href="/about/site.html">恍惚斋</a><sub class="site-subtitle"></sub><div class="site-desciption">面壁十年图破壁</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">43</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">3</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">18</span></a></div><a class="site-state-item hty-icon-button" href="/about/#comment" title="留言板"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-clipboard-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/Xf-Zhou" title="GitHub" target="_blank" style="color:#181717"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:2102813085@qq.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#JVM初探"><span class="toc-number">1.</span> <span class="toc-text">JVM初探</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1、JVM的位置"><span class="toc-number">1.1.</span> <span class="toc-text">1、JVM的位置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2、JVM体系结构"><span class="toc-number">1.2.</span> <span class="toc-text">2、JVM体系结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3、类加载器"><span class="toc-number">1.3.</span> <span class="toc-text">3、类加载器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、双亲委派"><span class="toc-number">1.3.1.</span> <span class="toc-text">1、双亲委派</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、面试问题"><span class="toc-number">1.3.2.</span> <span class="toc-text">2、面试问题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4、沙箱安全机制"><span class="toc-number">1.4.</span> <span class="toc-text">4、沙箱安全机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、什么是沙箱"><span class="toc-number">1.4.1.</span> <span class="toc-text">1、什么是沙箱</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、组成沙箱的基本组件"><span class="toc-number">1.4.2.</span> <span class="toc-text">2、组成沙箱的基本组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5、Native"><span class="toc-number">1.5.</span> <span class="toc-text">5、Native</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6、PC寄存器"><span class="toc-number">1.6.</span> <span class="toc-text">6、PC寄存器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7、方法区"><span class="toc-number">1.7.</span> <span class="toc-text">7、方法区</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8、栈"><span class="toc-number">1.8.</span> <span class="toc-text">8、栈-</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、栈里面存放什么"><span class="toc-number">1.8.1.</span> <span class="toc-text">1、栈里面存放什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、栈运行原理"><span class="toc-number">1.8.2.</span> <span class="toc-text">2、栈运行原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、栈堆方法区的交互关系"><span class="toc-number">1.8.3.</span> <span class="toc-text">3、栈堆方法区的交互关系</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9、三种JVM"><span class="toc-number">1.9.</span> <span class="toc-text">9、三种JVM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10、堆"><span class="toc-number">1.10.</span> <span class="toc-text">10、堆</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、堆里面存放什么"><span class="toc-number">1.10.1.</span> <span class="toc-text">1、堆里面存放什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、新生代"><span class="toc-number">1.10.2.</span> <span class="toc-text">2、新生代</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、养老区"><span class="toc-number">1.10.3.</span> <span class="toc-text">3、养老区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4、永久区"><span class="toc-number">1.10.4.</span> <span class="toc-text">4、永久区</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5、出现OOM"><span class="toc-number">1.10.5.</span> <span class="toc-text">5、出现OOM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6、VM-options参数"><span class="toc-number">1.10.6.</span> <span class="toc-text">6、VM options参数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11、GC垃圾回收"><span class="toc-number">1.11.</span> <span class="toc-text">11、GC垃圾回收</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1、GC的作用区域"><span class="toc-number">1.11.1.</span> <span class="toc-text">1、GC的作用区域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2、GC相关题目"><span class="toc-number">1.11.2.</span> <span class="toc-text">2、GC相关题目</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3、GC算法"><span class="toc-number">1.11.3.</span> <span class="toc-text">3、GC算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#引用计数法（现在基本不用）"><span class="toc-number">1.11.3.1.</span> <span class="toc-text">引用计数法（现在基本不用）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#复制算法（在新生代使用）"><span class="toc-number">1.11.3.2.</span> <span class="toc-text">复制算法（在新生代使用）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#标记清除"><span class="toc-number">1.11.3.3.</span> <span class="toc-text">标记清除</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#标记压缩"><span class="toc-number">1.11.3.4.</span> <span class="toc-text">标记压缩</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#标记清除压缩"><span class="toc-number">1.11.3.5.</span> <span class="toc-text">标记清除压缩</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#总结"><span class="toc-number">1.12.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JMM"><span class="toc-number">2.</span> <span class="toc-text">JMM</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://xfzhou95.com/2021/03/02/JVM/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="xfzhou"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="恍惚斋"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">JVM<a class="post-edit-link" href="https://github.com/Xf-Zhou/Xf-Zhou.github.io/tree/hexo/source/_posts/JVM.md" target="_blank" title="编辑" rel="noopener"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-edit-line"></use></svg></a></h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2021-03-02 22:52:01" itemprop="dateCreated datePublished" datetime="2021-03-02T22:52:01+08:00">2021-03-02</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="修改时间：2021-03-03 15:23:12" itemprop="dateModified" datetime="2021-03-03T15:23:12+08:00">2021-03-03</time></div><span class="leancloud_visitors" id="/2021/03/02/JVM/" data-flag-title="JVM"><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读次数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-eye-line"></use></svg> <span class="leancloud-visitors-count"></span></span></span><div class="post-classify"></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content post-markdown"><h1 id="JVM初探"><a href="#JVM初探" class="headerlink" title="JVM初探"></a>JVM初探</h1><p>参考：<a href="https://www.kuangstudy.com/bbs/1366583294535151617" target="_blank" rel="noopener">https://www.kuangstudy.com/bbs/1366583294535151617</a></p>
<p><a href="https://www.kuangstudy.com/bbs?searchKey=JVM&amp;cid=&amp;pageNo=1&amp;pageSize=15" target="_blank" rel="noopener">https://www.kuangstudy.com/bbs?searchKey=JVM&amp;cid=&amp;pageNo=1&amp;pageSize=15</a></p>
<p><strong>一些常见面试题：</strong></p>
<ul>
<li>请你谈谈你对JVM的理解？java8虚拟机和之前的变化更新？</li>
<li>什么是OOM，什么是栈溢出StackOverFlowError？怎么分析？</li>
<li>JVM的常用调优参数有哪些？</li>
<li>内存快照如何抓取，怎么分析Dump文件？知道吗？</li>
<li>谈谈JVM中，加载器你的认识？</li>
</ul>
<p>学习方式：</p>
<ol>
<li>百度，</li>
<li>思维导图<a href="https://www.processon.com/popular" target="_blank" rel="noopener">https://www.processon.com/popular</a></li>
</ol>
<h2 id="1、JVM的位置"><a href="#1、JVM的位置" class="headerlink" title="1、JVM的位置"></a>1、JVM的位置</h2><p><img src="JVM.assets/image-20210129163223110.png" alt="image-20210129163223110" loading="lazy"></p>
<h2 id="2、JVM体系结构"><a href="#2、JVM体系结构" class="headerlink" title="2、JVM体系结构"></a>2、JVM体系结构</h2><p><img src="JVM.assets/image-20210302225944378.png" alt="image-20210302225944378" loading="lazy"></p>
<p><img src="JVM.assets/image-20210131113845513.png" alt="image-20210131113845513" loading="lazy"></p>
<blockquote>
<p>本地方法接口：JNI（Java Native Interface）</p>
</blockquote>
<h2 id="3、类加载器"><a href="#3、类加载器" class="headerlink" title="3、类加载器"></a>3、类加载器</h2><blockquote>
<p>作用：加载Class文件。</p>
</blockquote>
<p><img src="JVM.assets/image-20210302231842145.png" alt="image-20210302231842145" loading="lazy"></p>
<p><img src="JVM.assets/image-20210129173753042.png" alt="image-20210129173753042" loading="lazy"></p>
<p><img src="JVM.assets/image-20210302231526982.png" alt="image-20210302231526982" loading="lazy"></p>
<ul>
<li>1、虚拟机自带的加载器</li>
<li>2、启动类（根）加载器【BOOT】</li>
<li>3、扩展类加载器【EXT】</li>
<li>4、应用程序（系统类）加载器【APP】</li>
</ul>
<p><strong>注：从4到1进行加载</strong>，我们自己定义的类一般都在应用程序加载器中加载！</p>
<p><img src="JVM.assets/image-20210302232506504.png" alt="image-20210302232506504" loading="lazy"></p>
<h3 id="1、双亲委派"><a href="#1、双亲委派" class="headerlink" title="1、双亲委派"></a>1、双亲委派</h3><p>*<em>解释：双亲委派机制（安全）：APP—&gt;EXT—&gt;BOOT【最终执行】 *</em></p>
<ol>
<li>类加载器收到类加载的请求</li>
<li>将这个请求向上委托为父类加载器去完成，一直向上委托，直到启动类加载器 BOOT</li>
<li>启动类加载器检查是否能够加载当前的这个类，能加载就结束，使用当前的加载器，否则抛出异常，通知子加载器进行加载</li>
<li>重复步骤 3</li>
</ol>
<blockquote>
<p>但是BOOT根加载器输出是null，这是java调用不到~   C，C++</p>
<p>Java = C++–：去掉繁琐的东西（指针、内存管理等）</p>
</blockquote>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>draco<span class="token punctuation">.</span>parents<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 双亲委派机制
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Car</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Car car1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Car car2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Car car3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Car</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//不同的实例</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"car1 hashCode="</span><span class="token operator">+</span>car1<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"car2 hashCode="</span><span class="token operator">+</span>car2<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"car3 hashCode="</span><span class="token operator">+</span>car3<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//同一个类模版</span>
        Class<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Car</span><span class="token operator">></span> aClass1 <span class="token operator">=</span> car1<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Class<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Car</span><span class="token operator">></span> aClass2 <span class="token operator">=</span> car2<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Class<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">Car</span><span class="token operator">></span> aClass3 <span class="token operator">=</span> car3<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"aClass1 hashCode="</span><span class="token operator">+</span>aClass1<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"aClass2 hashCode="</span><span class="token operator">+</span>aClass2<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"aClass3 hashCode="</span><span class="token operator">+</span>aClass3<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//由于类模版都是一个，以下就选择一个进行测试</span>
        ClassLoader classLoader <span class="token operator">=</span> aClass1<span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//AppClassLoader</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//ExtClassLoader  所在位置：\jre\lib\ext</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>classLoader<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">//null 1.不存在  2.java程序获取不到  所在位置：rt.jar</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<ul>
<li>运行测试结果：</li>
</ul>
<p><img src="JVM.assets/image-20210129185753713.png" alt="image-20210129185753713" loading="lazy"></p>
<h3 id="2、面试问题"><a href="#2、面试问题" class="headerlink" title="2、面试问题"></a>2、面试问题</h3><ul>
<li><p>为什么需要双亲委派机制?（也就是双亲委派的优点）</p>
<p>①双亲委派机制使得类加载出现层级，父类加载器加载过的类，子类加载器不会重复加载，可以<strong>防止类重复加载</strong>；</p>
<p>②使得类的加载出现优先级，<strong>防止了核心API被篡改</strong>，提升了安全，所以越基础的类就会越上层进行加载，反而一般自己的写的类，就会在应用程序加载器（Application）直接加载。</p>
</li>
<li><p>如何打破双亲委派？</p>
<p>①自定义类加载器，重写loadClass方法</p>
<p>②使用线程上下文类加载器</p>
</li>
</ul>
<h2 id="4、沙箱安全机制"><a href="#4、沙箱安全机制" class="headerlink" title="4、沙箱安全机制"></a>4、沙箱安全机制</h2><h3 id="1、什么是沙箱"><a href="#1、什么是沙箱" class="headerlink" title="1、什么是沙箱"></a>1、什么是沙箱</h3><p>​        沙箱是一个限制程序运行的环境。沙箱机制就是将 Java 代码限定在虚拟机(JVM)特定的运行范围中，并且严格限制代码对本地系统资源访问，通过这样的措施来保证对代码的有效隔离，防止对本地系统造成破坏。沙箱<strong>主要限制系统资源访问</strong>，那系统资源包括什么？——==CPU、内存、文件系统、网络==。不同级别的沙箱对这些资源访问的限制也可以不一样。</p>
<p>​        所有的Java程序运行都可以指定沙箱，可以定制安全策略。</p>
<h3 id="2、组成沙箱的基本组件"><a href="#2、组成沙箱的基本组件" class="headerlink" title="2、组成沙箱的基本组件"></a>2、组成沙箱的基本组件</h3><ul>
<li><code>字节码校验器</code>（bytecode verifier）：确保Java类文件遵循Java语言规范。这样可以帮助Java程序实现内存保护。但并不是所有的类文件都会经过字节码校验，比如核心类。</li>
<li><code>类装载器</code>（class loader）：其中类装载器在3个方面对Java沙箱起作用   <ul>
<li>它防止恶意代码去干涉善意的代码；</li>
<li>它守护了被信任的类库边界；</li>
<li>它将代码归入保护域，确定了代码可以进行哪些操作。</li>
</ul>
</li>
</ul>
<p>  虚拟机为不同的类加载器载入的类提供不同的命名空间，命名空间由一系列唯一的名称组成，每一个被装载的类将有一个名字，这个命名空间是由Java虚拟机为每一个类装载器维护的，它们互相之间甚至不可见。</p>
<p>  <strong>类装载器采用的机制是==双亲委派模式==。</strong></p>
<ol>
<li>从最内层JVM自带类加载器开始加载，外层恶意同名类得不到加载从而无法使用；</li>
<li>由于严格通过包来区分了访问域，外层恶意的类通过内置代码也无法获得权限访问到内层类，破坏代码就自然无法生效。</li>
</ol>
<ul>
<li><code>存取控制器</code>（access controller）：存取控制器可以控制核心API对操作系统的存取权限，而这个控制的策略设定，可以由用户指定。</li>
<li><code>安全管理器</code>（security manager）：是核心API和操作系统之间的主要接口。实现权限控制，比存取控制器优先级高。</li>
<li><code>安全软件包</code>（security package）：java.security下的类和扩展包下的类，允许用户为自己的应用增加新的安全特性，包括：   <ul>
<li>安全提供者</li>
<li>消息摘要</li>
<li>数字签名  keytools</li>
<li>加密</li>
<li>鉴别</li>
</ul>
</li>
</ul>
<h2 id="5、Native"><a href="#5、Native" class="headerlink" title="5、Native"></a>5、Native</h2><p>编写一个多线程启动类</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token class-name">Thread</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">"Thread1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>点进去start方法</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>threadStatus <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalThreadStateException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    group<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">boolean</span> started <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token function">start0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// 调用了start0()方法</span>
        started <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>started<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                group<span class="token punctuation">.</span><span class="token function">threadStartFailed</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ignore<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// 凡是带了native关键字的，就说明Java的作用范围达不到了，会去调用底层C语言的库</span>
<span class="token keyword">private</span> <span class="token keyword">native</span> <span class="token keyword">void</span> <span class="token function">start0</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//start0()方法的定义，这个方法会调用底层C</span></code></pre>
<blockquote>
<p>Java在内存区域中专门开辟了一块标记区域——本地方法栈，用来登记native方法，凡是带了native关键字的，会进入到本地方法栈中，调用本地方法接口（JNI），在最终执行的时候，加载本地方法库中的方法通过JNI</p>
</blockquote>
<p><img src="JVM.assets/image-20210302235015964.png" alt="image-20210302235015964" loading="lazy"></p>
<p><img src="JVM.assets/image-20210131125351239.png" alt="image-20210131125351239" loading="lazy"></p>
<ul>
<li><code>JNI的作用</code>：<strong>扩展Java的使用</strong>，<strong>融合不同的编程语言为Java所用</strong>，不过最初是想融合C，C++的，因为Java诞生的时候，C，C++横行，想要立足的话就要有能调用C的程序</li>
<li>它会在内存区域中专门开辟了一块标记区域：本地方法栈（Native Method Stack），在其中登记native方法，在最终执行引擎执行的时候加载Native Libraies【本地库】</li>
</ul>
<h2 id="6、PC寄存器"><a href="#6、PC寄存器" class="headerlink" title="6、PC寄存器"></a>6、PC寄存器</h2><p>程序计数器：Program Counter Register</p>
<p>​        <strong>每个线程都有一个程序计数器， 是线程私有的</strong>，就是一个指针， <strong>指向方法区中的方法字节码(用来存储指向像一条指令的地址， 也即将要执行的指令代码)</strong>，在执行引擎读取下一条指令,就+1 是一个非常小的内存空间，几乎可以忽略不计</p>
<p>百度到的资料：</p>
<ol>
<li><strong>程序计数器</strong></li>
</ol>
<p>1.1. <strong>程序计数器的本质</strong></p>
<p>从本质来看，程序技术器就是一块比较小的内存空间。</p>
<p>1.2. <strong>程序计数器的作用</strong></p>
<p>程序计数器可以看作是当前线程所执行字节码的行号指示器，也就是说，程序计数器这块小空间里面记录的是当前线程正在执行的字节码的行号。字节码解释器通过改变计数器的值来获取下一条要执行的字节码。分支、循环、跳转、异常处理、线程恢复等基础功能都需要依赖这个计数器来完成。</p>
<p>1.3. <strong>为什么程序计数器被设计成线程私有的？</strong></p>
<p>假如现在有一本书，有好几个同学都想看，我们采取这样的策略让所有同学都能看到：每个人看一天，不管看没看完都要交给下一个人看，不断循环，直到所有人看完。每个同学都有一个小卡片记录自己看到了哪里，这样下次轮到自己看的时候就能快速的接着上次看到的地方继续看。</p>
<p>Java虚拟机中多线程采用时间片轮转的方式实现，一个处理器（如果是多核处理器就是一个内核）同一时间只能被一个线程使用，同一时间只能执行一个线程的指令，当时间片用完，处理器就要交给别的线程使用，为了下一次轮到自己使用处理器是能够接着执行现在的指令，使用一个计数器来记录。</p>
<h2 id="7、方法区"><a href="#7、方法区" class="headerlink" title="7、方法区"></a>7、方法区</h2><p>方法区：Method Area</p>
<p>​        方法区是被所有线程共享，所有字段和方法字节码，以及一些特殊方法，如构造函数，接口代码也在此定义，简单说，所有定义的方法的信息都保存在该区域，<strong>此区域属于共享区间</strong>；</p>
<p>​        <strong>静态变量、常量、类信息(构造方法、接口定义)、运行时的常量池存在方法区中（1.7之前，1.7之后放在堆里），但是实例变量存在堆内存中，和方法区无关</strong>。简单的来说就是：==static、final、Class、常量池==</p>
<p><img src="JVM.assets/image-20210303001750615.png" alt="image-20210303001750615" loading="lazy"></p>
<h2 id="8、栈"><a href="#8、栈" class="headerlink" title="8、栈-"></a>8、栈-</h2><ul>
<li><p>程序 = 数据结构 + 算法 【持续学习】</p>
</li>
<li><p>大多数人程序 = 框架 + 业务逻辑【饭碗】</p>
</li>
</ul>
<blockquote>
<p>栈：先进后出，后进先出</p>
<p>队列：先进先出（FIFO：first input first output）</p>
</blockquote>
<p>喝多了吐就是栈，吃多了拉就是队列</p>
<p>栈：<strong>栈内存，主管程序的运行，生命周期和线程同步</strong>；栈是线程级的，一个线程就有一个栈。</p>
<p>线程结束，栈内存也就释放了，对于栈来说==不存在垃圾回收问题==，一旦线程结束，栈就Over了</p>
<p>为什么main（）先执行，最后结束~？<strong>因为它在栈最底端。</strong></p>
<p>栈的实例演示：</p>
<p><img src="JVM.assets/image-20210303003544368.png" alt="image-20210303003544368" loading="lazy"></p>
<h3 id="1、栈里面存放什么"><a href="#1、栈里面存放什么" class="headerlink" title="1、栈里面存放什么"></a>1、栈里面存放什么</h3><p>栈：8大基本类型 + 对象的引用 + 实例的方法</p>
<h3 id="2、栈运行原理"><a href="#2、栈运行原理" class="headerlink" title="2、栈运行原理"></a>2、栈运行原理</h3><p>栈帧：Stack Frame<a href="https://www.cnblogs.com/jhxxb/p/11001238.html" target="_blank" rel="noopener">https://www.cnblogs.com/jhxxb/p/11001238.html</a></p>
<p>子帧是为了调用子程序，子程序执行完通过父帧返回下面的方法。</p>
<p><img src="JVM.assets/image-20210201182918164.png" alt="image-20210201182918164" loading="lazy"></p>
<p>栈满了：StackOverflowError</p>
<h3 id="3、栈堆方法区的交互关系"><a href="#3、栈堆方法区的交互关系" class="headerlink" title="3、栈堆方法区的交互关系"></a>3、栈堆方法区的交互关系</h3><p><img src="JVM.assets/image-20210303005244314.png" alt="image-20210303005244314" loading="lazy"></p>
<p><img src="JVM.assets/image-20210201185248813.png" alt="image-20210201185248813" loading="lazy"></p>
<p>画出一个对象实例化的过程：</p>
<p><a href="https://blog.csdn.net/Tony__Jaa/article/details/107612059（精彩）" target="_blank" rel="noopener">https://blog.csdn.net/Tony__Jaa/article/details/107612059（精彩）</a></p>
<img src="JVM.assets/image-20210303005702448.png" alt="image-20210303005702448" style="zoom:67%;" / loading="lazy">

<p><img src="JVM.assets/image-20210303005732094.png" alt="image-20210303005732094" loading="lazy"></p>
<p><img src="JVM.assets/image-20210303005754086.png" alt="image-20210303005754086" loading="lazy"></p>
<p><img src="JVM.assets/image-20210303005808844.png" alt="image-20210303005808844" loading="lazy"></p>
<p><img src="JVM.assets/image-20210303005836279.png" alt="image-20210303005836279" loading="lazy"></p>
<p><img src="JVM.assets/image-20210303005852873.png" alt="image-20210303005852873" loading="lazy"></p>
<p><img src="JVM.assets/image-20210303005911807.png" alt="image-20210303005911807" loading="lazy"></p>
<h2 id="9、三种JVM"><a href="#9、三种JVM" class="headerlink" title="9、三种JVM"></a>9、三种JVM</h2><ul>
<li>Sun公司 HotSpot <code>Java HotSpot(TM) 64-Bit Server VM (build 25.121-b13, mixed mode)</code></li>
<li>BEA <code>JRockit</code></li>
<li>IBM <code>J9VM</code></li>
</ul>
<p>我们学习都是 <strong>HotSpot</strong></p>
<h2 id="10、堆"><a href="#10、堆" class="headerlink" title="10、堆"></a>10、堆</h2><blockquote>
<p><strong>Heap，一个JVM只有一个堆内存，堆内存的大小是可以调节的。</strong></p>
</blockquote>
<h3 id="1、堆里面存放什么"><a href="#1、堆里面存放什么" class="headerlink" title="1、堆里面存放什么"></a>1、堆里面存放什么</h3><p>类加载器读取了类文件后，一般会把什么东西放在堆中？ <em>类，方法，常量，变量，保存我们所有引用类型的真实对象</em></p>
<p>堆内存中还要细分为<strong>三个区域</strong>：新生代、老年代、永久代</p>
<ul>
<li>新生区（伊甸园区）young/new</li>
<li>养老区 old</li>
<li>永久区 perm</li>
</ul>
<p>==GC垃圾回收，主要在<strong>伊甸园区</strong>和<strong>养老区</strong>==</p>
<p><img src="JVM.assets/image-20210201210010927.png" alt="image-20210201210010927" loading="lazy"></p>
<p>假设内存满了，OOM，堆内存不够！<code>java.lang.OutOfMemoryError: Java heap space</code></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>draco<span class="token punctuation">.</span>heapOverflow<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Random<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 堆溢出
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HeapOver</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        String name <span class="token operator">=</span> <span class="token string">"adfjkllkjfdsa"</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            name <span class="token operator">+=</span> name <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">888888888</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">999999999</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p><img src="JVM.assets/image-20210201212708979.png" alt="image-20210201212708979" loading="lazy">在JDK8以后，永久存储区改了个名字叫：==元空间==</p>
<h3 id="2、新生代"><a href="#2、新生代" class="headerlink" title="2、新生代"></a>2、新生代</h3><ul>
<li>新生代：类诞生和成长的地方，甚至死亡；<ul>
<li>伊甸园区Eden space，所有对象都是在伊甸园区new出来的</li>
<li>幸存者区Survivior space（0、1）</li>
</ul>
</li>
</ul>
<p><img src="JVM.assets/image-20210201215342076.png" alt="image-20210201215342076" loading="lazy"></p>
<p>真理：经过研究，99%的对象都是临时对象！</p>
<h3 id="3、养老区"><a href="#3、养老区" class="headerlink" title="3、养老区"></a>3、养老区</h3><p>新生区没干掉，没杀死的来到了养老区~</p>
<h3 id="4、永久区"><a href="#4、永久区" class="headerlink" title="4、永久区"></a>4、永久区</h3><p>这个区域是常驻内存的。用来存放JDK自身携带的Class对象，Interface元数据，存储的是Java运行时的一些环境或类信息，这个区域不存在垃圾回收！当关闭JVM虚拟机就会释放这个区域的内存。</p>
<p>一个启动类加载了大量的第三方jar包；Tomcat部署了太多的应用；大量动态生成的反射类等 不断的被加载，直到内存满，<strong>就会出现OOM</strong>。</p>
<ul>
<li>jdk1.6 之前：永久代，常量池是在方法区中；</li>
<li>jdk1.7         ：永久代，但是慢慢退化了，<code>去永久代</code>，常量池在堆中</li>
<li>jdk1.8 之后：无永久代，常量池在元空间</li>
</ul>
<p><img src="JVM.assets/image-20210303134431520.png" alt="image-20210303134431520" loading="lazy"></p>
<p><img src="JVM.assets/image-20210201222307209.png" alt="image-20210201222307209" loading="lazy"></p>
<blockquote>
<p>但是，元空间：逻辑上存在，物理上不存在</p>
</blockquote>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>draco<span class="token punctuation">.</span>heapOverflow<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 元空间逻辑上存在，物理上不存在
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SanQu</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 返回jvm试图使用的最大内存</span>
        <span class="token keyword">long</span> max <span class="token operator">=</span> Runtime<span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">maxMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// 返回jvm的初始化内存</span>
        <span class="token keyword">long</span> total <span class="token operator">=</span> Runtime<span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">totalMemory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"max="</span><span class="token operator">+</span>max<span class="token operator">+</span><span class="token string">"字节\t"</span><span class="token operator">+</span><span class="token punctuation">(</span>max<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"MB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"total="</span><span class="token operator">+</span>total<span class="token operator">+</span><span class="token string">"字节\t"</span><span class="token operator">+</span><span class="token punctuation">(</span>total<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"MB"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">//默认情况下，试图分配的最大内存是电脑内存的1/4，而初始化的内存是1/64</span>
        <span class="token comment" spellcheck="true">// -Xms1024m -Xmx1024m -XX:+PrintGCDetails</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>运行结果：</p>
<p><img src="JVM.assets/image-20210201230739376.png" alt="image-20210201230739376" loading="lazy"></p>
<p>当修改了VM选项后：<code>-Xms1024m -Xmx1024m -XX:+PrintGCDetails</code>，输出结果：</p>
<p><img src="JVM.assets/image-20210201230953431.png" alt="image-20210201230953431" loading="lazy"></p>
<p>让我们来算一笔账，</p>
<p>新生区：305664k；养老区：699392k</p>
<p>加在一起：1,005,056k，除以1024后 = 981.5MB，等于jvm试图分配的最大内存，所以说元空间逻辑上存在，物理上不存在。</p>
<h3 id="5、出现OOM"><a href="#5、出现OOM" class="headerlink" title="5、出现OOM"></a>5、出现OOM</h3><p><strong>怎么去分析错误？</strong></p>
<ol>
<li><p>尝试扩大堆内存去查看内存结果</p>
<p><code>-Xms1024m -Xmx1024m -XX:+PrintGCDetails</code></p>
</li>
<li><p>若不行，分析内存，看一下是哪个地方出现了问题（专业工具）</p>
<ul>
<li>能够看到代码第几行出错：内存快照分析工具，MAT（eclipse），Jprofiler</li>
<li>Debug，一行行分析代码！（不现实）</li>
</ul>
</li>
</ol>
<p>MAT，Jprofiler作用：</p>
<ul>
<li>分析Dump内存文件，快速定位内存泄漏</li>
<li>获得堆中的数据</li>
<li>获得大的对象</li>
<li>……</li>
</ul>
<p>运行出现堆溢出：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>draco<span class="token punctuation">.</span>heapOverflow<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ArrayList<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JprofilerTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> array <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">byte</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">*</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ArrayList<span class="token operator">&lt;</span>JprofilerTest<span class="token operator">></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">JprofilerTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                count<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
            System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"count="</span><span class="token operator">+</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>设置VM options <code>-Xms1m -Xmx8m -XX:+HeapDumpOnOutOfMemoryError</code>后，再次运行，控制台输出：</p>
<p><img src="JVM.assets/image-20210202134131995.png" alt="image-20210202134131995" loading="lazy"></p>
<p>找到HPROF快照</p>
<p><img src="JVM.assets/image-20210202140158342.png" alt="image-20210202140158342" loading="lazy"></p>
<p>双击打开</p>
<p><img src="JVM.assets/image-20210303142057401.png" alt="image-20210303142057401" loading="lazy"></p>
<p><img src="JVM.assets/image-20210303142134391.png" alt="image-20210303142134391" loading="lazy"></p>
<p><img src="JVM.assets/image-20210202140606282.png" alt="image-20210202140606282" loading="lazy"></p>
<p>修改代码，把try catch中的Exception改成Error后运行：</p>
<p><img src="JVM.assets/image-20210202172145431.png" alt="image-20210202172145431" loading="lazy"></p>
<h3 id="6、VM-options参数"><a href="#6、VM-options参数" class="headerlink" title="6、VM options参数"></a>6、VM options参数</h3><p>-Xms    设置初始化内存分配大小，默认1/64</p>
<p>-Xmx    设置最大分配内存，默认1/4</p>
<p>-XX:+PrintGCDetails    打印GC垃圾回收信息</p>
<p>-XX:+HeapDumpOnOutOfMemoryError    生成oomDump文件</p>
<p><code>-Xms1m -Xmx8m -XX:+HeapDumpOnOutOfMemoryError</code></p>
<p><code>-Xms1024m -Xmx1024m -XX:+PrintGCDetails</code></p>
<h2 id="11、GC垃圾回收"><a href="#11、GC垃圾回收" class="headerlink" title="11、GC垃圾回收"></a>11、GC垃圾回收</h2><h3 id="1、GC的作用区域"><a href="#1、GC的作用区域" class="headerlink" title="1、GC的作用区域"></a>1、GC的作用区域</h3><p><img src="JVM.assets/image-20210202173224815.png" alt="image-20210202173224815" loading="lazy"></p>
<p>JVM在进行GC时，并不是对这三个区域统一回收，大部分时候，回收都是新生代</p>
<ul>
<li>新生代</li>
<li>幸存区（from to）【会交换的，不是一成不变的】</li>
<li>老年代</li>
</ul>
<p>GC两种类型：轻GC（普通的GC），重GC（full GC/全局GC）</p>
<h3 id="2、GC相关题目"><a href="#2、GC相关题目" class="headerlink" title="2、GC相关题目"></a>2、GC相关题目</h3><ul>
<li>JVM的内存模型和分区~详细到每个区放什么？</li>
<li>堆里面的分区有哪些？Eden，from，to，old，说说他们的特点~</li>
<li>GC的算法有哪些？<strong>标记清除法，标记整理/压缩法，复制算法</strong>，引用计数法，怎么用的？</li>
<li>轻GC和重GC分别在什么时候发生？</li>
</ul>
<h3 id="3、GC算法"><a href="#3、GC算法" class="headerlink" title="3、GC算法"></a>3、GC算法</h3><h4 id="引用计数法（现在基本不用）"><a href="#引用计数法（现在基本不用）" class="headerlink" title="引用计数法（现在基本不用）"></a>引用计数法（现在基本不用）</h4><p><a href="https://www.cnblogs.com/igoodful/p/8727241.html" target="_blank" rel="noopener">https://www.cnblogs.com/igoodful/p/8727241.html</a> 引用计数法和可达性分析法</p>
<p><img src="JVM.assets/image-20210202191444745.png" alt="image-20210202191444745" loading="lazy"></p>
<blockquote>
<p>哪个对象的引用数为0，就会回收哪个对象</p>
</blockquote>
<h4 id="复制算法（在新生代使用）"><a href="#复制算法（在新生代使用）" class="headerlink" title="复制算法（在新生代使用）"></a>复制算法（在新生代使用）</h4><p><img src="JVM.assets/image-20210303144317200.png" alt="image-20210303144317200" loading="lazy"></p>
<p><img src="JVM.assets/image-20210202200613995.png" alt="image-20210202200613995" loading="lazy"></p>
<p>动态过程：</p>
<p><img src="JVM.assets/image-20210303144607610.png" alt="image-20210303144607610" loading="lazy"></p>
<blockquote>
<p>一般新生代（伊甸园区、幸存区）会使用复制算法，生成新的to区</p>
</blockquote>
<ul>
<li>好处：没有内存的碎片</li>
<li>坏处：浪费了内存空间，多了一半空间永远是空to   （假设极端情况，对象100%存活，一直复制来复制去很浪费空间）</li>
</ul>
<p>==复制算法最佳使用场景：对象存活度较低的时候，也就是新生区==</p>
<h4 id="标记清除"><a href="#标记清除" class="headerlink" title="标记清除"></a>标记清除</h4><p><img src="JVM.assets/image-20210303145636120.png" alt="image-20210303145636120" loading="lazy"></p>
<p><img src="JVM.assets/image-20210202203154896.png" alt="image-20210202203154896" loading="lazy"></p>
<ul>
<li>缺点：两次扫描，严重浪费时间，会产生内存碎片</li>
<li>优点：不需要额外的空间</li>
</ul>
<h4 id="标记压缩"><a href="#标记压缩" class="headerlink" title="标记压缩"></a>标记压缩</h4><p>对于标记清除的再压缩</p>
<p><img src="JVM.assets/image-20210303145906612.png" alt="image-20210303145906612" loading="lazy"></p>
<p>但是又多了一个移动成本</p>
<h4 id="标记清除压缩"><a href="#标记清除压缩" class="headerlink" title="标记清除压缩"></a>标记清除压缩</h4><p>先标记清除几次，然后再压缩</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>内存效率：复制算法 （1次）&gt; 标记清除算法 （2次）&gt; 标记压缩算法（3次）（<strong>时间复杂度</strong>）</p>
<p>内存整齐度：复制算法 = 标记压缩算法 &gt; 标记清除算法</p>
<p>内存利用率：标记压缩算法 = 标记清除算法 &gt; 复制算法</p>
<p>思考：难道没有最优算法吗？</p>
<p>答案：<strong>没有，没有最好的算法，只有最合适的</strong>——&gt;GC：<strong>分代收集算法</strong><a href="https://blog.csdn.net/mccand1234/article/details/52078645" target="_blank" rel="noopener">https://blog.csdn.net/mccand1234/article/details/52078645</a></p>
<p><strong>新生代：</strong></p>
<ul>
<li>存活率低</li>
<li>复制算法</li>
</ul>
<p><strong>老年代：</strong></p>
<ul>
<li>区域大，存活率高</li>
<li>标记清除（内存碎片不是太多） + 标记压缩混合实现</li>
</ul>
<p>还是要多看书《深入理解JVM》，花时间去深究，多看面试题。</p>
<h1 id="JMM"><a href="#JMM" class="headerlink" title="JMM"></a>JMM</h1><ol>
<li><p>什么是JMM？</p>
<p>JMM：<strong>Java Memory Model</strong>的缩写 ，java内存模型</p>
</li>
<li><p>它干嘛的？</p>
<p>作用：缓存一致性协议，用于定义数据读写的规则。</p>
<p>JMM定义了<strong>线程工作内存和主内存之间的抽象关系</strong>，线程之间的共享内存存储在主内存（Main Memory）中，每个线程都有一个私有的本地内存（Local Memory）</p>
</li>
</ol>
<p><img src="JVM.assets/image-20210202211809212.png" alt="image-20210202211809212" loading="lazy"></p>
<p>解决共享对象可见性这个问题：voliate</p>
<ol start="3">
<li><p>它该如何学习？</p>
<p>JMM：抽象的概念，理论</p>
<p>去学习voliate关键字等等</p>
</li>
</ol>
<p>参考：</p>
<p>Java内存模型（JMM）总结 <a href="https://zhuanlan.zhihu.com/p/29881777" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/29881777</a></p>
<p>BAT经典面试题，深入理解Java内存模型JMM <a href="https://www.jianshu.com/p/51768fcdf6cb" target="_blank" rel="noopener">https://www.jianshu.com/p/51768fcdf6cb</a></p>
<p>最后：==拥抱开源时代，享受技术给我们带来的新体验==</p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">如果喜欢就点赞or赞赏</div><div id="qr" style="display:none;"><div style="display:inline-block"><a href="https://cdn.jsdelivr.net/gh/xf-zhou/CDN/img/donate/alipay-qrcode.jpg" target="_blank" rel="noopener"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/xf-zhou/CDN/img/donate/alipay-qrcode.jpg" alt="支付宝" title="支付宝"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a href="https://cdn.jsdelivr.net/gh/xf-zhou/CDN/img/donate/wechatpay-qrcode.png" target="_blank" rel="noopener"><img loading="lazy" src="https://cdn.jsdelivr.net/gh/xf-zhou/CDN/img/donate/wechatpay-qrcode.png" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>xfzhou</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://xfzhou95.com/2021/03/02/JVM/" title="JVM">https://xfzhou95.com/2021/03/02/JVM/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2021/03/02/Redis/" rel="prev" title="Redis"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">Redis</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/02/28/%E6%96%B0%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9/asserts/js/popper.min/" rel="next" title="新建文件夹/asserts/js/popper.min"><span class="post-nav-text">新建文件夹/asserts/js/popper.min</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>点击按钮跳转 GitHub Issues 评论。</span><br><span>若没有本文 Issue，您可以使用 Comment 模版新建。</span><br><a class="hty-button hty-button--raised" id="github-issues" href="https://github.com/YunYouJun/yunyoujun.github.io/issues?q=is:issue+JVM" target="_blank" rel="noopener">GitHub Issues</a></div><div id="valine-container"></div><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script>function initValine() {
  const valineConfig = {"enable":true,"appId":"Ly4ohwKW5DOjAswrfhXkSbDp-gzGzoHsz","appKey":"7JcswEnhHmu9mlhqlDVWRzon","placeholder":"说点什么","avatar":null,"meta":["nick","mail","link"],"pageSize":10,"visitor":true,"recordIP":true,"enableQQ":true,"requiredFields":["nick","mail"],"highlight":true,"el":"#valine-container","lang":"zh-cn"}
  valineConfig.path = window.location.pathname
  new Valine(valineConfig)
}
setTimeout(initValine, 1000)</script></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-user-line"></use></svg></span><span class="author"> xfzhou</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v4.2.1</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v0.9.0</span></div><div class="live_time"><span>本博客已萌萌哒地运行</span><span id="display_live_time"></span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  window.setTimeout(blog_live_time, 1000);
  const start = new Date('2019-06-19T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#6200ee" stroke-width="2" stroke-linecap="round"></circle></svg></a></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script></body></html>